# Task List 管理 (Task List Management)

## 核心功能

本 skill 自动管理任务列表，提供以下功能：
- **进度可视化**：实时显示当前执行阶段和完成进度
- **工作流透明化**：清晰展示所有阶段流程和每个阶段的状态
- **断点恢复**：支持中断后继续执行，自动识别断点
- **任务可复用**：任务列表可被其他工作流引用

## 自动任务管理

Skill 开始时自动创建任务列表，无需手动管理。任务列表包含 N 个主任务，对应 N 个阶段：

```
[项目名称]
├── 阶段 1: [阶段名称]
├── 阶段 2: [阶段名称]
├── ...
└── 阶段 N: [阶段名称]
```

## 进度显示格式

每个阶段开始/结束时显示当前进度：

```markdown
### 任务进度
[项目名称] - 总进度: X% (Y/N 阶段完成)

[完成] 阶段 1: [名称] (已完成)
[完成] 阶段 2: [名称] (已完成)
[跳过] 阶段 3: [名称] (已跳过)
[进行中] 阶段 4: [名称] (进行中...)
[等待] 阶段 5-N: (等待中)
```

## 任务管理操作

### 基本操作

```markdown
# 开始阶段时
tasks = TaskList()
task = findTaskBySubject(tasks, "阶段 X: [阶段名称]")
TaskUpdate(task.id, status="in_progress", owner="[skill-name]")

# 完成阶段时
TaskUpdate(task.id, status="completed")
```

### 条件执行阶段

对于条件执行的阶段（如外部资源研究）：

```markdown
# 如果决定执行此阶段
TaskUpdate(task.id, status="in_progress", owner="[skill-name]")

# 如果跳过此阶段（标记为 completed，解除对下一阶段的阻塞）
TaskUpdate(task.id, status="completed", metadata={note: "不满足执行条件，已跳过"})
```

### 等待用户确认

对于需要用户确认的阶段：

```markdown
# 向用户展示方案后，不要标记为 completed
# 等待用户确认后再执行：
TaskUpdate(task.id, status="completed")
```

## 断点恢复机制

如果 skill 执行中断，使用以下方法恢复：

1. **检查任务状态**: `TaskList()`
2. **查找当前任务**: 找到 `in_progress` 或 `pending` 状态的任务
3. **继续执行**: 从该任务继续
4. **跳过已完成**: 已标记为 `completed` 的阶段自动跳过

### 恢复示例

```markdown
### 检测到未完成的任务列表

[项目名称] - 当前进度: X%

上次的进度：
[完成] 阶段 1-N (已完成)
[进行中] 阶段 N+1: [阶段名称] (进行中)

是否从阶段 N+1 继续执行？
```

## 错误处理与降级

如果 Task list 功能不可用（MCP 服务故障等），skill 会自动降级到无 Task list 模式，继续执行主流程，并向用户说明情况。

```markdown
### Task List 功能不可用

Task list 功能暂时不可用，将使用标准模式执行工作流。

[继续执行主流程...]
```

## 最终进度显示

所有阶段完成后：

```markdown
### [完成] 所有阶段完成！

[项目名称] - 100% 完成

📝 阶段完成情况：
[完成] 阶段 1: [阶段名称]
[完成] 阶段 2: [阶段名称]
[跳过] 阶段 3: [阶段名称] (已跳过)
...
[完成] 阶段 N: [阶段名称]

项目成功完成！
```
